{"ast":null,"code":"var _jsxFileName = \"/home/gma/Escritorio/TALLER/FINAL/proyecto-software-FRONTEND/src/components/StockEventsTable.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport './StockEventsTable.css';\nimport Table from 'react-bootstrap/Table';\nimport StockDetail from './StockDetail';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction StockEventsTable(props) {\n  _s();\n\n  const {\n    searchValues,\n    products,\n    stockEvents,\n    shopValues\n  } = props;\n  const [initialShop, setShopValues] = useState([{\n    code: '',\n    name: '',\n    price: 0,\n    cant: 0,\n    id: 0\n  }]);\n  let localCart = localStorage.getItem('cart-items');\n\n  function findArrayElementByCode(array, code) {\n    return array.find(element => {\n      return element.code == code;\n    });\n  }\n\n  function getIndex(code) {\n    return initialShop.findIndex(obj => obj.code === code);\n  }\n\n  const addMoreItem = (a, b, c, d, i) => {\n    if (!findArrayElementByCode(initialShop, a)) {\n      console.log(\"nuevo\");\n\n      if (initialShop[0].code == '') {\n        console.log(\"vacio eliminado\");\n        let newShop = initialShop;\n        newShop[0] = {\n          code: a,\n          name: b,\n          price: c,\n          cant: parseInt(d),\n          id: i\n        };\n        setShopValues(newShop);\n        localStorage.setItem('cart-items', JSON.stringify(newShop)); //importante\n      } else {\n        //console.log(\"nuevo item\")\n        setShopValues(prevItems => [...prevItems, {\n          code: a,\n          //prevItems.length,\n          name: b,\n          //getRandomNumber(),\n          price: c,\n          cant: d,\n          id: i\n        }]);\n      }\n    } else {\n      //console.log(\"repetido\")\n      const i = getIndex(a);\n      let newShop = initialShop;\n      newShop[i].cant = parseInt(newShop[i].cant) + parseInt(d);\n      setShopValues(newShop);\n      localStorage.setItem('cart-items', JSON.stringify(newShop)); //importante\n    }\n  };\n\n  useEffect(() => {\n    localCart = JSON.parse(localCart); //console.log(localCart)\n\n    if (localCart) {\n      //console.log(\"recuperado en inv\")\n      if (localCart.length > 0 && localCart[0].name !== '') {\n        //console.log(localCart)\n        setShopValues(localCart);\n      } else {\n        setShopValues(initialShop);\n      }\n    } else {\n      setShopValues(initialShop);\n    }\n  }, []);\n  useEffect(() => {\n    shopValues(initialShop);\n    localStorage.setItem('cart-items', JSON.stringify(initialShop)); //console.log(\"aqui inv\")\n    //console.log(initialShop)\n  }, [initialShop]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"StockEventTable\",\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      size: \"sm\",\n      children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: products.filter(product => {\n          //console.log(product.name.toLowerCase())\n          //console.log(product.cat.toLowerCase())\n          //console.log(product.fab.toLowerCase())\n          //console.log(product.model.toLowerCase())\n          //console.log(product.ver.toLowerCase())\n          if (product.name == undefined) {\n            product.name = '';\n          }\n\n          if (product.cat == undefined) {\n            product.cat = '';\n          }\n\n          if (product.fab == undefined) {\n            product.fab = '';\n          }\n\n          if (product.model == undefined) {\n            product.model = '';\n          }\n\n          if (product.ver == undefined) {\n            product.ver = '';\n          }\n\n          if (product.year == undefined) {\n            product.year = '';\n          }\n\n          if (product.price == undefined) {\n            product.price = '';\n          }\n\n          if (searchValues.code == \"\" && searchValues.name == \"\" && searchValues.cat == \"\" && searchValues.fab == \"\" && searchValues.model == \"\" && searchValues.ver == \"\" && searchValues.year == \"\" && searchValues.stock == \"\" && searchValues.price == \"\") {\n            //console.log(\"limpio\")\n            return product;\n          } else if (product.name.toLowerCase().includes(searchValues.name.toLowerCase()) && product.cat.toLowerCase().includes(searchValues.cat.toLowerCase()) && product.code.toLowerCase().includes(searchValues.code.toLowerCase()) && product.fab.toLowerCase().includes(searchValues.fab.toLowerCase()) && product.model.toLowerCase().includes(searchValues.model.toLowerCase()) && product.ver.toLowerCase().includes(searchValues.ver.toLowerCase())) {\n            //product.name.toLowerCase().includes(searchValues.name.toLowerCase())\n            if (searchValues.year != \"\" || searchValues.stock != \"\" || searchValues.price != \"\") {\n              var stock = product.stock; //console.log(stockTotal)\n\n              var year1 = parseInt(product.year.substring(0, 4));\n              var year2 = parseInt(product.year.substring(5, 9)); //var stock = parseInt(product.stock)\n\n              var price = parseInt(product.price); //console.log(price)\n              //console.log(searchValues.price)\n\n              if (searchValues.year != \"\" && searchValues.price != \"\" && searchValues.stock != \"\") {\n                if (searchValues.year >= year1 && searchValues.year <= year2 && searchValues.price >= price && searchValues.stock >= stock) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year != \"\" && searchValues.price != \"\" && searchValues.stock == \"\") {\n                if (searchValues.year >= year1 && searchValues.year <= year2 && searchValues.price >= price) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year != \"\" && searchValues.price == \"\" && searchValues.stock == \"\") {\n                if (searchValues.year >= year1 && searchValues.year <= year2) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year == \"\" && searchValues.price != \"\" && searchValues.stock == \"\") {\n                if (searchValues.price >= price) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year == \"\" && searchValues.price == \"\" && searchValues.stock != \"\") {\n                if (searchValues.stock >= stock) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year == \"\" && searchValues.price != \"\" && searchValues.stock != \"\") {\n                if (searchValues.stock >= stock && searchValues.price >= price) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } else if (searchValues.year != \"\" && searchValues.price == \"\" && searchValues.stock != \"\") {\n                if (searchValues.year >= year1 && searchValues.year <= year2 && searchValues.stock >= stock) {\n                  /*|| product.year==''*/\n                  //console.log(searchValues.year)\n                  return product;\n                }\n              } //console.log(year1)\n              //console.log(year2)\n\n            } else {\n              return product;\n            } //console.log(searchValues.name.toLowerCase())\n            //console.log(product.name.toLowerCase())\n            //return product\n\n          }\n        }).map((product, i) => {\n          //const {id} = product\n          const relevantStockEvents = stockEvents.filter(se => se.product.id === product.id);\n          /*const stockTotal = relevantStockEvents.reduce((accumulator, currentElement) => {\n              return accumulator + currentElement.qty\n          }, 0)*/\n\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(StockDetail, {\n              id: product.id,\n              code: product.code,\n              name: product.name,\n              cat: product.cat,\n              fab: product.fab,\n              model: product.model,\n              ver: product.ver,\n              year: product.year,\n              price: product.price\n              /*total  = {stockTotal}*/\n              ,\n              stock: product.stock,\n              ubicacion: product.ubicacion,\n              origen: product.origen,\n              nota: product.nota,\n              stockEvents: relevantStockEvents,\n              addItem: addMoreItem\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 37\n            }, this)\n          }, void 0, false);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 9\n  }, this);\n}\n\n_s(StockEventsTable, \"oxDHlgubZbz3gFcl82O2nINLmPE=\");\n\n_c = StockEventsTable;\nexport default StockEventsTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"StockEventsTable\");","map":{"version":3,"sources":["/home/gma/Escritorio/TALLER/FINAL/proyecto-software-FRONTEND/src/components/StockEventsTable.jsx"],"names":["React","useEffect","useState","Table","StockDetail","StockEventsTable","props","searchValues","products","stockEvents","shopValues","initialShop","setShopValues","code","name","price","cant","id","localCart","localStorage","getItem","findArrayElementByCode","array","find","element","getIndex","findIndex","obj","addMoreItem","a","b","c","d","i","console","log","newShop","parseInt","setItem","JSON","stringify","prevItems","parse","length","filter","product","undefined","cat","fab","model","ver","year","stock","toLowerCase","includes","year1","substring","year2","map","relevantStockEvents","se","ubicacion","origen","nota"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport './StockEventsTable.css';\nimport Table from 'react-bootstrap/Table';\nimport StockDetail from './StockDetail';\n\n\nfunction StockEventsTable(props){\n   \n    const {searchValues, products, stockEvents, shopValues} = props    \n\n    const [initialShop, setShopValues] = useState([\n        {code: '', name: '', price:0, cant:0, id:0},\n    ])\n\n    let localCart = localStorage.getItem('cart-items');\n\n    function findArrayElementByCode(array, code) {\n        return array.find((element) => {\n          return element.code == code;\n        })\n      }\n    \n    function getIndex(code) {\n    return initialShop.findIndex(obj => obj.code === code);\n    }\n\n    const addMoreItem = (a,b,c,d, i) => {\n        if (!findArrayElementByCode(initialShop, a)){\n            console.log(\"nuevo\")\n            if(initialShop[0].code == ''){\n                console.log(\"vacio eliminado\")\n                let newShop = initialShop\n                newShop[0] = {code: a, name: b, price: c, cant: parseInt(d), id: i}\n                setShopValues(newShop)\n                localStorage.setItem('cart-items', JSON.stringify(newShop))//importante\n            }else{\n                //console.log(\"nuevo item\")\n                setShopValues(prevItems => [...prevItems, {\n                    code: a,//prevItems.length,\n                    name: b,//getRandomNumber(),\n                    price: c,\n                    cant: d,\n                    id: i\n                }]);\n            }\n        }else{\n            //console.log(\"repetido\")\n            const i = getIndex(a)\n            let newShop = initialShop\n            newShop[i].cant = parseInt(newShop[i].cant) + parseInt(d)\n            setShopValues(newShop)\n            localStorage.setItem('cart-items', JSON.stringify(newShop)) //importante\n        }\n    }\n    \n    useEffect(() => {\n        localCart = JSON.parse(localCart);\n        //console.log(localCart)\n        if(localCart){\n            //console.log(\"recuperado en inv\")\n            if(localCart.length > 0 && localCart[0].name!==''){\n                //console.log(localCart)\n                setShopValues(localCart)\n            }else{\n                setShopValues(initialShop)\n            }\n        }else{\n            setShopValues(initialShop)\n        }\n    },[]);\n\n    useEffect(() => {\n        shopValues(initialShop)\n        localStorage.setItem('cart-items', JSON.stringify(initialShop))\n        //console.log(\"aqui inv\")\n        //console.log(initialShop)\n    },[initialShop]);\n   \n    return (\n        \n        <div className = \"StockEventTable\">\n            <Table striped bordered hover size=\"sm\">\n                <tbody>\n                    {products.filter((product) => {\n                        //console.log(product.name.toLowerCase())\n                        //console.log(product.cat.toLowerCase())\n                        //console.log(product.fab.toLowerCase())\n                        //console.log(product.model.toLowerCase())\n                        //console.log(product.ver.toLowerCase())\n                        if(product.name==undefined){\n                            product.name=''\n                        }\n                        if(product.cat==undefined){\n                            product.cat=''\n                        }\n                        if(product.fab==undefined){\n                            product.fab=''\n                        }\n                        if(product.model==undefined){\n                            product.model=''\n                        }\n                        if(product.ver==undefined){\n                            product.ver=''\n                        }\n                        if(product.year==undefined){\n                            product.year=''\n                        }\n                        if(product.price==undefined){\n                            product.price=''\n                        }\n                        if(searchValues.code==\"\" && searchValues.name==\"\" && searchValues.cat==\"\" && searchValues.fab==\"\" && searchValues.model==\"\" && searchValues.ver==\"\" && searchValues.year==\"\" && searchValues.stock==\"\" && searchValues.price==\"\"){\n                            //console.log(\"limpio\")\n                            return product\n                        }else if(product.name.toLowerCase().includes(searchValues.name.toLowerCase()) \n                                && product.cat.toLowerCase().includes(searchValues.cat.toLowerCase())\n                                && product.code.toLowerCase().includes(searchValues.code.toLowerCase())  \n                                && product.fab.toLowerCase().includes(searchValues.fab.toLowerCase())\n                                && product.model.toLowerCase().includes(searchValues.model.toLowerCase())\n                                && product.ver.toLowerCase().includes(searchValues.ver.toLowerCase())){ //product.name.toLowerCase().includes(searchValues.name.toLowerCase())\n                                if(searchValues.year!=\"\" || searchValues.stock!=\"\" || searchValues.price!=\"\"){\n\n                                    var stock = product.stock\n\n                                    //console.log(stockTotal)\n\n                                    var year1 = parseInt(product.year.substring(0, 4))\n                                    var year2 = parseInt(product.year.substring(5, 9))\n                                    //var stock = parseInt(product.stock)\n                                    var price = parseInt(product.price)\n                                    //console.log(price)\n                                    //console.log(searchValues.price)\n                                    if(searchValues.year!=\"\" && searchValues.price!=\"\" && searchValues.stock!=\"\"){\n                                        if ((searchValues.year >= year1 && searchValues.year <= year2) && searchValues.price >= price && searchValues.stock >= stock){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year!=\"\" && searchValues.price!=\"\" && searchValues.stock==\"\"){\n                                        if ((searchValues.year >= year1 && searchValues.year <= year2) && searchValues.price >= price){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year!=\"\" && searchValues.price==\"\" && searchValues.stock==\"\"){\n                                        if (searchValues.year >= year1 && searchValues.year <= year2){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year==\"\" && searchValues.price!=\"\" && searchValues.stock==\"\"){\n                                        if (searchValues.price >= price){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year==\"\" && searchValues.price==\"\" && searchValues.stock!=\"\"){\n                                        if (searchValues.stock >= stock){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year==\"\" && searchValues.price!=\"\" && searchValues.stock!=\"\"){\n                                        if (searchValues.stock >= stock && searchValues.price >= price){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }else if(searchValues.year!=\"\" && searchValues.price==\"\" && searchValues.stock!=\"\"){\n                                        if ((searchValues.year >= year1 && searchValues.year <= year2) && searchValues.stock >= stock){ /*|| product.year==''*/\n                                            //console.log(searchValues.year)\n                                            return product\n                                        }\n                                    }\n                                    //console.log(year1)\n                                    //console.log(year2)\n                                }else{\n                                    return product\n                                }\n                            //console.log(searchValues.name.toLowerCase())\n                            //console.log(product.name.toLowerCase())\n                            //return product\n                        }\n                    }).map((product, i) => {\n                        //const {id} = product\n\n                        const relevantStockEvents = stockEvents.filter(se => se.product.id === product.id)\n\n                        /*const stockTotal = relevantStockEvents.reduce((accumulator, currentElement) => {\n                            return accumulator + currentElement.qty\n                        }, 0)*/\n                        return(\n                            <>\n                            {/*<div className = \"StockEventTable__ProductContainer\">*/}\n                            {/*{product.id} */}\n                                    < StockDetail \n                                            id = {product.id} \n                                            code = {product.code}\n                                            name = {product.name}\n                                            cat = {product.cat}\n                                            fab = {product.fab}\n                                            model = {product.model}\n                                            ver = {product.ver}\n                                            year = {product.year}\n                                            price = {product.price}\n                                            /*total  = {stockTotal}*/\n                                            stock  = {product.stock}\n                                            ubicacion = {product.ubicacion} \n                                            origen = {product.origen} \n                                            nota = {product.nota}\n                                            stockEvents = {relevantStockEvents}\n                                            addItem = {addMoreItem}\n                                    />\n                                    \n                            {/*</div> */}\n                            </>\n                        )\n                    })}\n                </tbody>\n            </Table>\n        </div>\n            \n    )\n}\n\nexport default StockEventsTable;"]},"metadata":{},"sourceType":"module"}